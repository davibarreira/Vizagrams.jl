<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>7 - Composite Visualizations · Vizagrams.jl</title><meta name="title" content="7 - Composite Visualizations · Vizagrams.jl"/><meta property="og:title" content="7 - Composite Visualizations · Vizagrams.jl"/><meta property="twitter:title" content="7 - Composite Visualizations · Vizagrams.jl"/><meta name="description" content="Documentation for Vizagrams.jl."/><meta property="og:description" content="Documentation for Vizagrams.jl."/><meta property="twitter:description" content="Documentation for Vizagrams.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Vizagrams.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Vizagrams.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../1_basics/">1 - Diagramming Basics</a></li><li><a class="tocitem" href="../2_custommarks/">2 - Custom Marks</a></li><li><a class="tocitem" href="../3_datavisualization/">3 - Data Vizualization Basics</a></li><li><a class="tocitem" href="../4_expressiveness/">4 - Graphic Expressions</a></li><li><a class="tocitem" href="../5_customization/">5 - Customizing Visualizations</a></li><li><a class="tocitem" href="../6_polar/">6 - Polar Visualizations</a></li><li class="is-active"><a class="tocitem" href>7 - Composite Visualizations</a><ul class="internal"><li><a class="tocitem" href="#1.-Facet-Plots"><span>1. Facet Plots</span></a></li><li><a class="tocitem" href="#1.1-Facet-Plot-via-Diagramming"><span>1.1 Facet Plot via Diagramming</span></a></li><li><a class="tocitem" href="#1.2-Facet-Plot-via-Plot-Specification"><span>1.2 Facet Plot via Plot Specification</span></a></li><li><a class="tocitem" href="#2.-Nesting"><span>2. Nesting</span></a></li><li><a class="tocitem" href="#3.-Integrated"><span>3. Integrated</span></a></li></ul></li></ul></li><li><span class="tocitem">Gallery</span><ul><li><a class="tocitem" href="../../gallery/boxplot/">BoxPlot</a></li><li><a class="tocitem" href="../../gallery/groupedbar/">Grouped Bar Chart</a></li><li><a class="tocitem" href="../../gallery/histogram/">Histogram</a></li><li><a class="tocitem" href="../../gallery/minard/">Minard&#39;s Chart</a></li><li><a class="tocitem" href="../../gallery/moritz/">OECD Better Life Index</a></li><li><a class="tocitem" href="../../gallery/pca/">PCA</a></li><li><a class="tocitem" href="../../gallery/penguins/">Penguins</a></li><li><a class="tocitem" href="../../gallery/nightingale/">Rose Diagram</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>7 - Composite Visualizations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>7 - Composite Visualizations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/davibarreira/Vizagrams.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/davibarreira/Vizagrams.jl/blob/master/docs/src/tutorials/7_composite.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Composite-Visualizations"><a class="docs-heading-anchor" href="#Composite-Visualizations">Composite Visualizations</a><a id="Composite-Visualizations-1"></a><a class="docs-heading-anchor-permalink" href="#Composite-Visualizations" title="Permalink"></a></h1><p>Composite visualizations are those that combine distinct plots to form a single visualization. A simple example of this are subplots, where one stacks plots together either vertically or horizontally. There are several ways to produce composite plots. Let us explore how to do them using Vizagrams.</p><h2 id="1.-Facet-Plots"><a class="docs-heading-anchor" href="#1.-Facet-Plots">1. Facet Plots</a><a id="1.-Facet-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Facet-Plots" title="Permalink"></a></h2><p>Facet plots are those where the data is broken into distinct columns. In Vizagrams, this kind of plot can be done in different ways. One way consists in using the plot specification with another plot specification inside. The second way involves grouping the data and then combining the plots using the diagramming operations.</p><h2 id="1.1-Facet-Plot-via-Diagramming"><a class="docs-heading-anchor" href="#1.1-Facet-Plot-via-Diagramming">1.1 Facet Plot via Diagramming</a><a id="1.1-Facet-Plot-via-Diagramming-1"></a><a class="docs-heading-anchor-permalink" href="#1.1-Facet-Plot-via-Diagramming" title="Permalink"></a></h2><p>Let us start with the diagramming way.</p><pre><code class="language-julia hljs">using Vizagrams
using StatsBase
using DataFrames
using Random
using VegaDatasets

df = DataFrame(dataset(&quot;cars&quot;));
df[!,:Year] = map(x-&gt;parse(Int,x[3:4]),df.Year)
df = dropmissing(df);

facet = ∑(i=:Origin,op=→) do gdf
    Plot(
        title=gdf.Origin[1],
        config=(;legends=NilD()),
        data=gdf,
        x=(field=:Horsepower,scale_domain=(40,250)),
        y=(field=:Miles_per_Gallon,scale_domain=(0,50)),
    )
end(df)

draw(facet,width=800)</code></pre><img src="123f4aef.svg" alt="Example block output"/><p>Note that, in the code above, we are using the <code>∑</code> operator to group the dataset <code>df</code> using the column <code>Origin</code>. Once the dataset is grouped, we create a plot. Then, each plot is combined using the beside operator <code>→</code>.</p><p>One might wish to apply different colors to each plot. This can be done by creating a scale function, as shown next:</p><pre><code class="language-julia hljs">colorscale = infer_scale(data=df.Origin, variable=:color)
facet = ∑(i=:Origin,op=→) do gdf
    Plot(
        title=gdf.Origin[1],
        config=(;legends=NilD()),
        data=gdf,
        x=(field=:Horsepower,scale_domain=(40,250)),
        y=(field=:Miles_per_Gallon,scale_domain=(0,50)),
        color=(value=row-&gt;colorscale(row.Origin),scale=IdScale()),
    )
end(df)

draw(facet,width=800)</code></pre><img src="f54035a1.svg" alt="Example block output"/><h2 id="1.2-Facet-Plot-via-Plot-Specification"><a class="docs-heading-anchor" href="#1.2-Facet-Plot-via-Plot-Specification">1.2 Facet Plot via Plot Specification</a><a id="1.2-Facet-Plot-via-Plot-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#1.2-Facet-Plot-via-Plot-Specification" title="Permalink"></a></h2><p>It is also possible to create a facet plot using a plot specification.</p><pre><code class="language-julia hljs">facet = Plot(
    config=(
        figsize=(300,200),
        coordinate=nothing,
        frame=NilD(),
        legends=(;transform=T(1030,200)),
        ),
    data=df,
    x=(field=:Horsepower,scale=IdScale()),
    y=(field=:Miles_per_Gallon,scale=IdScale()),
    color=(field=:Origin,),
    origin=(field=:Origin,scale=IdScale()),

    graphic= data-&gt;begin
        ∑(i=:color,op=(x,y)-&gt;x→(T(10,0),y)) do gdf
            Plot(
                title=gdf.origin[1],
                config=(legends=NilD(),xaxis=(;title=&quot;&quot;)),
                data=gdf,
                x=(field=:x,scale_domain=(0,250)),
                y=(field=:y,scale_domain=(0,50)),
                color=(field=:color,scale=IdScale()))
        end(data)↓(T(0,-10),TextMark(text=&quot;Horsepower&quot;,pos=[150,0]))
    end
)
draw(facet,width=800)</code></pre><img src="3f527ce1.svg" alt="Example block output"/><h2 id="2.-Nesting"><a class="docs-heading-anchor" href="#2.-Nesting">2. Nesting</a><a id="2.-Nesting-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Nesting" title="Permalink"></a></h2><p>Nested visualizations are those where we place a plot inside another plot. In a sense, we can think of the previous facet plots as a nested visualization, as can be more clearly seen in the example using a single plot specification.</p><p>Let us start with a common example. We do a pizza plot nested inside a scatter plot.</p><pre><code class="language-julia hljs">plt = Plot(
    data=df,
    figsize=(500,300),
    x=(field=:Year,scale_domain=(68,84)),
    y=:Cylinders,
    color = (field=:Origin,datatype=:n,),
    angle = (field=:Origin, scale=IdScale()),
    size = (field=:Acceleration, scale_range=(2.0,20)),
    graphic= ∑(i=:x,∑(i=:y) do rows
            acc = mean(rows.size)
            countvalues = sort(countmap(rows.color))
            colors = collect(keys(countvalues))
            angles = 2π.*values(countvalues)./length(rows.angle)
            T(rows.x[1],rows.y[1])U(acc)*
            Pizza(angles=angles,colors=colors,style=S(:strokeWidth=&gt;0.5))
    end)
)

draw(plt)</code></pre><img src="c7060b9f.svg" alt="Example block output"/><p>Next, we do a more complex example, showcasing the customization capabilities.</p><pre><code class="language-julia hljs">plt = Plot(
    config=(;
        figsize=(400,170),
        frame=NilD(),
        xaxis=(;axisarrow=NilD(),tickmark=NilD()),
        yaxis=(;axisarrow=NilD(),tickmark=S(:opacity=&gt;0)Circle(r=2),ticktextangle=π/2),
        xgrid=NilD(),
        ygrid=(;style=S(:strokeWidth=&gt;48,:vectorEffect=&gt;&quot;none&quot;,:strokeOpacity=&gt;0.03)),
        legends=(;transform=T(420,120)U(0.5))
        ),
    data=df,
    x=(field=:Cylinders),
    y=(field=:Origin),
    color=(field=:Acceleration,),
    horsepower=(field=:Horsepower,scale=IdScale()),
    miles=(field=:Miles_per_Gallon,scale=IdScale()),
    cylinder=(field=:Cylinders,scale=IdScale(),datatype=:o),
    origin=(field=:Origin,scale=IdScale()),

    graphic=
        ∑(i=:cylinder,orderby=:cylinder,descend=true,
            ∑(i=:origin,orderby=:origin,) do gdf
                T(gdf.x[1],gdf.y[1])*
            centralize_graphic(U(0.19)*
                Plot(
                    config=(
                        frame_style=S(:fill=&gt;:white,:fillOpacity=&gt;1.0,),
                        legends=NilD(),
                        yaxis=(;title=&quot;&quot;),
                        xaxis=(;title=&quot;&quot;)),
                    data=gdf,
                    x=(field=:horsepower,scale_domain=(0,250)),
                    y=(field=:miles,scale_domain=(0,50)),
                    color=(field=:color,scale=IdScale())
            ))
            end
    )
)
draw(plt,width=800)</code></pre><img src="cf0bb88c.svg" alt="Example block output"/><h2 id="3.-Integrated"><a class="docs-heading-anchor" href="#3.-Integrated">3. Integrated</a><a id="3.-Integrated-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Integrated" title="Permalink"></a></h2><p>Integrated visualizations are those where distinct plots are somehow integrated. A common example of this would be parallel coordinate plots. The difficulty in creating such visualizations involves having to coordinate distict scales in order.</p><p>Our example is inspired in one of the visualizations presented in the paper &quot;Dece: Decision explorer with counterfactual explanations for machine learning models&quot; (2020, Cheng, Furui and Ming, Yao and Qu, Huamin).</p><p>Let us start by creating a dataset.</p><pre><code class="language-julia hljs">Random.seed!(4)
toefl = 10randn(100) .+ 300
rating = 10randn(100) .+ 100
score = 5rand(100) .+ 5;
accept = rand([0,0,1],100);
df = DataFrame(:toefl=&gt;toefl,:rating=&gt;rating,:score=&gt;score,:accept=&gt;accept);</code></pre><p>Next, we create a horizontal bar plot:</p><pre><code class="language-julia hljs">plt_accept = Plot(
    title = &quot;Acceptance&quot;,
    config=(;grid=NilD(),
        xaxis=(;title=&quot;count&quot;),
        yaxis=(;title=&quot;&quot;),
        ),
    data=df,
    x=(value=row-&gt;sum(df.accept .== row.accept),scale_domain=(0,70)),
    y=:accept,
    graphic=∑(i=:y) do rows
        S(:fill=&gt;:steelblue)T(0,rows.y[1])Bar(w=rows.x[1],h=50,orientation=:h)
    end
)
draw(plt_accept)</code></pre><svg height="300" viewBox="-14.758424479166667 -230.4526953125 319.1642447916667 263.860859375" width="364.9738256737863" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" version="1.1"><polygon points="0.0 0.0 300.0 0.0 300.0 200.0 0.0 200.0 " style="vector-effect: non-scaling-stroke; stroke: lightgray; fill: white; stroke-width: 1.0; fill-opacity: 0; " transform="scale(1,-1)" /><polyline points="0 0 300 0 " style="vector-effect: non-scaling-stroke; stroke: black; fill: none; " transform="scale(1,-1)" /><polygon points="300.15000000000003 1.4802973661663703e-17 300.0 0.08660254037846364 300.0 -0.0866025403784635 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><polygon points="-0.5 -4.0 0.5 -4.0 0.5 0.0 -0.5 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="0.0" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.052083333333332) rotate(-0.0, 0.0, -12.526041666666666)" y="-12.526041666666666">0</text><polygon points="85.21428571428571 -4.0 86.21428571428571 -4.0 86.21428571428571 0.0 85.21428571428571 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="85.71428571428571" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.09765625) rotate(-0.0, 85.71428571428571, -12.548828125)" y="-12.548828125">20</text><polygon points="170.92857142857142 -4.0 171.92857142857142 -4.0 171.92857142857142 0.0 170.92857142857142 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="171.42857142857142" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.088541666666664) rotate(-0.0, 171.42857142857142, -12.544270833333332)" y="-12.544270833333332">40</text><polygon points="256.6428571428571 -4.0 257.6428571428571 -4.0 257.6428571428571 0.0 256.6428571428571 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="257.1428571428571" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.106770833333332) rotate(-0.0, 257.1428571428571, -12.553385416666666)" y="-12.553385416666666">60</text><text x="148.94934895833336" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 57.94921875) rotate(-0.0, 148.94934895833336, -28.974609375)" y="-28.974609375">count</text><polyline points="0 0 0 200 " style="vector-effect: non-scaling-stroke; stroke: black; fill: none; " transform="scale(1,-1)" /><polygon points="5.721188726174236e-19 200.15 -0.08660254037846363 199.99999999999997 0.0866025403784635 199.99999999999997 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><polygon points="-4.0 49.5 0.0 49.5 0.0 50.5 -4.0 50.5 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="-8.251302083333334" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 -93.0) rotate(-0.0, -8.251302083333334, 46.5)" y="46.5">0</text><polygon points="-4.0 149.5 0.0 149.5 0.0 150.5 -4.0 150.5 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="-7.205403645833332" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 -293.0) rotate(-0.0, -7.205403645833332, 146.5)" y="146.5">1</text><text x="3.5" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 -0.0) rotate(-90.0, 3.5, 0.0)" y="0.0"></text><polygon points="0.0 0.0 300.0 0.0 300.0 200.0 0.0 200.0 " style="vector-effect: non-scaling-stroke; stroke: lightgray; fill: white; stroke-width: 1.0; fill-opacity: 0; " transform="scale(1,-1)" /><polyline points="0 0 300 0 " style="vector-effect: non-scaling-stroke; stroke: black; fill: none; " transform="scale(1,-1)" /><polygon points="300.15000000000003 6.47630097696998e-18 300.0 0.08660254037846365 300.0 -0.08660254037846343 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><polygon points="-0.5 -4.0 0.5 -4.0 0.5 0.0 -0.5 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="0.0" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.052083333333332) rotate(-0.0, 0.0, -12.526041666666666)" y="-12.526041666666666">0</text><polygon points="85.21428571428571 -4.0 86.21428571428571 -4.0 86.21428571428571 0.0 85.21428571428571 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="85.71428571428571" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.09765625) rotate(-0.0, 85.71428571428571, -12.548828125)" y="-12.548828125">20</text><polygon points="170.92857142857142 -4.0 171.92857142857142 -4.0 171.92857142857142 0.0 170.92857142857142 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="171.42857142857142" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.088541666666664) rotate(-0.0, 171.42857142857142, -12.544270833333332)" y="-12.544270833333332">40</text><polygon points="256.6428571428571 -4.0 257.6428571428571 -4.0 257.6428571428571 0.0 256.6428571428571 0.0 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="257.1428571428571" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 25.106770833333332) rotate(-0.0, 257.1428571428571, -12.553385416666666)" y="-12.553385416666666">60</text><text x="148.94934895833336" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 57.94921875) rotate(-0.0, 148.94934895833336, -28.974609375)" y="-28.974609375">count</text><polyline points="0 0 0 200 " style="vector-effect: non-scaling-stroke; stroke: black; fill: none; " transform="scale(1,-1)" /><polygon points="8.898791557311146e-18 200.15 -0.08660254037846364 199.99999999999997 0.08660254037846345 199.99999999999997 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><polygon points="-4.0 49.5 0.0 49.5 0.0 50.5 -4.0 50.5 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="-8.251302083333334" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 -93.0) rotate(-0.0, -8.251302083333334, 46.5)" y="46.5">0</text><polygon points="-4.0 149.5 0.0 149.5 0.0 150.5 -4.0 150.5 " style="vector-effect: non-scaling-stroke; " transform="scale(1,-1)" /><text x="-7.205403645833332" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 -293.0) rotate(-0.0, -7.205403645833332, 146.5)" y="146.5">1</text><text x="3.5" style="font-family: Helvetica; text-anchor: middle; vector-effect: non-scaling-stroke; font-size: 7.0pt; " transform="translate(0 -0.0) rotate(-90.0, 3.5, 0.0)" y="0.0"></text><text x="0.0" style="font-family: Helvetica; text-anchor: start; vector-effect: non-scaling-stroke; font-size: 13.0pt; " transform="translate(0 -427.5278645833333) rotate(-0.0, 0.0, 213.76393229166666)" y="213.76393229166666">Acceptance</text><polygon points="0.0 25.0 278.57142857142856 25.0 278.5714285714285 75.0 -5.684341886080802e-14 75.0 " style="vector-effect: non-scaling-stroke; fill: steelblue; " transform="scale(1,-1)" /><polygon points="0.0 125.0 150.0 125.0 150.0 175.0 0.0 175.0 " style="vector-effect: non-scaling-stroke; fill: steelblue; " transform="scale(1,-1)" /></svg><p>Our goal next is to create histograms for the other variables and stack them horizontally. For this, we define a function <code>tohist</code> to envelope our histogram specification.</p><pre><code class="language-julia hljs">function tohist(data, title)
    Plot(
        title = title,
        config=(;
            grid=NilD(),
            xaxis=(;title=&quot;count&quot;),
            yaxis=(;tickvalues=bin_edges(data),title=&quot;&quot;),
            ),
        y = bindata(data),
        x = (value=countbin(data),scale_domain=(0,maximum(countbin(data))+2)),

        graphic = data-&gt; begin
        # compute the bin width
        w = let
            u = sort(unique(data.y))
            u[2]-u[1]-1
        end

        # draw each bar
        ∑(i=:y) do row
                S(:fillOpacity=&gt;0.9,:fill=&gt;:steelblue)*
                T(0,row.y[1])Bar(h=w,w=row.x[1],orientation=:h)
        end(data)
    end
    )
end

data = [toefl,rating,score]
plts = map(x-&gt;tohist(x[1],x[2]),zip(data,[&quot;TOEFL&quot;,&quot;RATING&quot;,&quot;SCORE&quot;]));
plts = vcat(plts,plt_accept)
plt = reduce((x,y)-&gt;x→(T(10,0),y),plts);

draw(plt,width=800)</code></pre><img src="e9805f11.svg" alt="Example block output"/><p>Up until now, this visualization is simply a sort of facet plot. The next step is to draw lines accross this plot in order to illustrate how a single observed row varies accross these different dimensions.</p><pre><code class="language-julia hljs">gs = getmarkpath(Plot,plt,G)
lines = mapreduce(+,1:10) do i
    pts = map(zip(plts,[:toefl,:rating,:score,:accept],gs)) do row
        y = getscale(row[1],:y)(df[i,row[2]])
        pos = row[3]([0.0,y])
        pos = row[3]([0.0,y])
    end
    S(:stroke=&gt;:orange)Line(pts)
end

d = plt + lines
draw(d,width=800)</code></pre><img src="644f154d.svg" alt="Example block output"/><p>To draw the lines we must obtain the position in each axis and apply the same translation as used in each plot. To do this, we must do two things. First, we must get the scale in each plot, and apply it to the <code>y</code> value in our lines. Secondly, we must get how much each plot is translated left, and use this in the <code>x</code> value. The first task is done using the <code>getscale</code> function, while the second is done using the <code>getmarkpath</code> function.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../6_polar/">« 6 - Polar Visualizations</a><a class="docs-footer-nextpage" href="../../gallery/boxplot/">BoxPlot »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 23 September 2024 12:39">Monday 23 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
