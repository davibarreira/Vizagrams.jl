<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rose Diagram · Vizagrams.jl</title><meta name="title" content="Rose Diagram · Vizagrams.jl"/><meta property="og:title" content="Rose Diagram · Vizagrams.jl"/><meta property="twitter:title" content="Rose Diagram · Vizagrams.jl"/><meta name="description" content="Documentation for Vizagrams.jl."/><meta property="og:description" content="Documentation for Vizagrams.jl."/><meta property="twitter:description" content="Documentation for Vizagrams.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Vizagrams.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Vizagrams.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/1_basics/">1 - Diagramming Basics</a></li><li><a class="tocitem" href="../../tutorials/2_custommarks/">2 - Custom Marks</a></li><li><a class="tocitem" href="../../tutorials/3_datavisualization/">3 - Data Vizualization Basics</a></li><li><a class="tocitem" href="../../tutorials/4_expressiveness/">4 - Graphic Expressions</a></li><li><a class="tocitem" href="../../tutorials/5_customization/">5 - Customizing Visualizations</a></li><li><a class="tocitem" href="../../tutorials/6_polar/">6 - Polar Visualizations</a></li><li><a class="tocitem" href="../../tutorials/7_composite/">7 - Composite Visualizations</a></li></ul></li><li><span class="tocitem">Gallery</span><ul><li><a class="tocitem" href="../boxplot/">BoxPlot</a></li><li><a class="tocitem" href="../groupedbar/">Grouped Bar Chart</a></li><li><a class="tocitem" href="../histogram/">Histogram</a></li><li><a class="tocitem" href="../minard/">Minard&#39;s Chart</a></li><li><a class="tocitem" href="../moritz/">OECD Better Life Index</a></li><li><a class="tocitem" href="../pca/">PCA</a></li><li><a class="tocitem" href="../penguins/">Penguins</a></li><li class="is-active"><a class="tocitem" href>Rose Diagram</a><ul class="internal"><li><a class="tocitem" href="#1.-Importing-the-Data"><span>1. Importing the Data</span></a></li><li><a class="tocitem" href="#2.-Initial-Polar-Plot"><span>2. Initial Polar Plot</span></a></li><li><a class="tocitem" href="#3.-Rose-Diagram"><span>3. Rose Diagram</span></a></li><li><a class="tocitem" href="#4.-Complete-Rose-Diagram"><span>4. Complete Rose Diagram</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Gallery</a></li><li class="is-active"><a href>Rose Diagram</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rose Diagram</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/davibarreira/Vizagrams.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/davibarreira/Vizagrams.jl/blob/master/docs/src/gallery/nightingale.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Nightingale&#39;s-Rose-Diagram"><a class="docs-heading-anchor" href="#Nightingale&#39;s-Rose-Diagram">Nightingale&#39;s Rose Diagram</a><a id="Nightingale&#39;s-Rose-Diagram-1"></a><a class="docs-heading-anchor-permalink" href="#Nightingale&#39;s-Rose-Diagram" title="Permalink"></a></h1><p>This example recreates the famous rose diagram by Florence Nightingale. You can read about this plot <a href="https://www.historyofinformation.com/detail.php?entryid=3815">here</a>.</p><h2 id="1.-Importing-the-Data"><a class="docs-heading-anchor" href="#1.-Importing-the-Data">1. Importing the Data</a><a id="1.-Importing-the-Data-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Importing-the-Data" title="Permalink"></a></h2><p>Let us begin simply by importing the data into two dataframes. We have already adjusted the data for our plots.</p><pre><code class="language-julia hljs">using Vizagrams
using DataFrames
using Random
using CSV
using Dates

path = joinpath(pkgdir(Vizagrams), &quot;docs&quot;, &quot;src&quot;, &quot;assets&quot;, &quot;nightingale1.csv&quot;)
df1 = DataFrame(CSV.File(path));
path = joinpath(pkgdir(Vizagrams), &quot;docs&quot;, &quot;src&quot;, &quot;assets&quot;, &quot;nightingale2.csv&quot;)
df2 = DataFrame(CSV.File(path));</code></pre><h2 id="2.-Initial-Polar-Plot"><a class="docs-heading-anchor" href="#2.-Initial-Polar-Plot">2. Initial Polar Plot</a><a id="2.-Initial-Polar-Plot-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Initial-Polar-Plot" title="Permalink"></a></h2><p>With the data adjusted, let us create a single plot in order to get a better sense for the final diagram.</p><pre><code class="language-julia hljs"># The colors close to the original diagram
colors = [&quot;#93bee2ff&quot;,&quot;#f2a4abff&quot;,&quot;#808080ff&quot;]

plt = Plot(
    data=df1,
    config=(
        raxis=(angle=3π/4,tickvalues=[0,20,40,60,80,100]),
        coordinate=:polar,
        figsize=(300,300),
        ),
    encodings=(
        r = (
            field=:countsqr,
            datatype=:q,
            scale_domain =(0,100),),
        angle = (
            field=:month,
            datatype=:n,
            scale_domain = Dates.LOCALES[&quot;english&quot;].months,
            ),
        cause=(field=:order,scale=IdScale()),
        color = (field=:cause,scale_range=colors),
        date = (field=:datetime,scale=IdScale()),
    ),
    graphic = ∑(i=:date,orderby=:cause,descend=false) do rows
        rmaj = cumsum(rows.r)
        rmin = vcat(0,rmaj[begin:end-1])
        ∑() do row
            S(:fill=&gt;row.color,:opacity=&gt;1.0)*
            Slice(rmajor=row.rmaj,rminor=row.rmin,θ=row.angle+π/2-π/12,ang=π/6)
        end(hconcat(rows,rmaj=rmaj,rmin=rmin))
    end
);

draw(plt, height=500)</code></pre><img src="ed91fc91.svg" alt="Example block output"/><h2 id="3.-Rose-Diagram"><a class="docs-heading-anchor" href="#3.-Rose-Diagram">3. Rose Diagram</a><a id="3.-Rose-Diagram-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Rose-Diagram" title="Permalink"></a></h2><p>The plot above is very close to the original plot, but there are still some modifications we must do. For example, we must remove the axes, and write the months next to each slice. Since we want to create two rose diagrams, let us define a function that takes the data as input and produces our plot. The function is mostly just passing the plot complete specification with the data as an argument.</p><pre><code class="language-julia hljs">function roseplot(data; title=&quot;&quot;,legends=true, legend_transform=T(0,0))
    if legends == false
        legends = NilD()
    else
        legends = (;transform=legend_transform)
    end
    return Plot(
        data=data,
        title=T(0,100)TextMark(text=title, fontsize=8),
        config=(
            coordinate=:polar,
            frame=NilD(),
            grid=NilD(),
            axes=NilD(),
            legends=legends,
            ),
        encodings=(
            r = (
                field=:countsqr,
                datatype=:q,
                scale_domain =(0,100), scale_range=(1,150)),
            angle = (
                field=:month,
                datatype=:n,
                scale_domain = Dates.LOCALES[&quot;english&quot;].months,
                scale_range = collect(range(0, -2π; length=12 + 1))[begin:(end-1)]
                ),
            month=(field=:month, datatype=:n,scale=IdScale()),
            cause=(field=:order,scale=IdScale()),
            color = (field=:cause,scale_range=colors),
            date = (field=:datetime,scale=IdScale()),
        ),
        graphic = data-&gt;
        R(-π/2)*∑(i=:date,orderby=:cause,descend=false) do rows
            rmaj = cumsum(rows.r)
            rmin = vcat(0,rmaj[begin:end-1])
            slices = ∑() do row
                S(:fill=&gt;row.color,:opacity=&gt;1.0)*
                Slice(rmajor=row.rmaj,rminor=row.rmin,θ=row.angle-1.5π-π/12,ang=π/6)
            end(hconcat(rows,rmaj=rmaj,rmin=rmin))

            r_text = max(rmaj[end]+5,50)
            x = cos(rows.angle[1]) * r_text
            y = sin(rows.angle[1]) * r_text
            return slices +
                   T(x,y)TextMark(text=rows.month[1],angle=rows.angle[1]-π/2,fontsize=4)
        end(data)
    );
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">roseplot (generic function with 1 method)</code></pre><p>With this function implemented, we can create the two diagrams.</p><pre><code class="language-julia hljs">rose1 = roseplot(df1, title=&quot;April 1854 to March 1855&quot;,legends=false)
rose2 = roseplot(df2, title=&quot;April 1855 to March 1856&quot;,
                legends=true,legend_transform=T(-50,-90)U(0.7))

draw(rose2 + T(300,0)rose1,height=400,width=800)</code></pre><img src="ac071aa3.svg" alt="Example block output"/><h2 id="4.-Complete-Rose-Diagram"><a class="docs-heading-anchor" href="#4.-Complete-Rose-Diagram">4. Complete Rose Diagram</a><a id="4.-Complete-Rose-Diagram-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Complete-Rose-Diagram" title="Permalink"></a></h2><p>The previous diagram is very close to the original rose diagram, but we can make it even closer to the original. In the original, there is a line between each rose that is used to indicate where the first rose ends and the other begins. We can also add a title over the whole diagram. </p><pre><code class="language-julia hljs">ang = -π/2 + π/12 + getscale(rose1,:angle)(&quot;April&quot;)
x = cos(ang)*90
y = sin(ang)*90

posrose1 = [x,y]
posrose1 = T(300,0)(posrose1)

ang = -π/2 + π/12 + getscale(rose2,:angle)(&quot;April&quot;)
x = cos(ang)*60
y = sin(ang)*60
posrose2 = [x,y]

l = S(:strokeDasharray=&gt;5)Line([posrose1,[100,-50],posrose2])
d = rose2 + T(300,0)rose1 + l

maintitle = TextMark(text=&quot;Diagram of the Causes of Mortality&quot;,fontfamily=&quot;monospace&quot;)
subtitle = TextMark(text=&quot;in the Army in the East&quot;,fontfamily=&quot;monospace&quot;)
title = maintitle ↓ (T(0,-5),subtitle)

d = d + T(0,150)acenter(d,title)*title

draw(d,height=400,width=800)</code></pre><img src="6314e00a.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../penguins/">« Penguins</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 30 September 2024 14:30">Monday 30 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
